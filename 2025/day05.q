(r:"J"$"-"vs';i:"J"$1_):(0,where""~/:i)_i:read0`05.txt
sum any@'i within/:\:r
p:asc distinct raze r
count[p]+wsum[-1+1_deltas p]any@'(1_p-1)within/:\:r