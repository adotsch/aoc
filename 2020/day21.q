i:`${`ig`al!(" "vs x 0;", "vs x 1)}'[" (contains "vs/:-1_/:read0`:21.txt]
/ part 1
f:{als:x 0;igs:x 1;i:x 2;
  a:distinct raze i`al;
  m:where 1=(count')ing:{[x;y]last{x where 0<count'[x]}(inter\)exec ig from x where y in/:al}[i]'[a];
  igs,:raze ing m;
  (als,a m;igs;update ig:ig except\:igs,al:al except\:a[m] from i)
 }
r:f/[(();();i)]
sum not raze[i.ig] in r 1
/ part 2
1 "," sv string r[1] iasc r 0